<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬äºŒæ—¥ é‡‘é–£é–ƒè€€ã€å¸‚äº•æ¼«æ­¥èˆ‡è³¼ç‰©å…¨æ”»ç•¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <style>
        /* --- å…¨å±€èˆ‡åŸºç¤é¢¨æ ¼ --- */
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8f9fa; /* æ›´æŸ”å’Œçš„èƒŒæ™¯è‰² */
            color: #212529; /* æ·±ç°è‰²ï¼Œæé«˜å¯è®€æ€§ */
        }
        h1, h2, h3, h4, h5, h6 { font-family: 'Noto Serif TC', serif; }
        .section {
            padding-top: 88px; /* å°è¦½åˆ—é«˜åº¦çš„åç§» */
            margin-top: -88px;
        }

        /* --- é ‚éƒ¨å°è¦½åˆ— --- */
        .navbar {
            transition: background-color 0.3s, box-shadow 0.3s;
            border-bottom: 1px solid transparent;
        }
        .navbar-scrolled {
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-bottom: 1px solid #e5e7eb;
        }
        .nav-link {
            position: relative;
            transition: color 0.3s;
            padding: 24px 0;
            font-weight: 500;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 3px;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: #c0842b; /* é‡‘è‰² */
            transition: width 0.3s ease-in-out;
        }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .nav-link:hover, .nav-link.active { color: #c0842b; }

        /* --- å…§å®¹å¡ç‰‡èˆ‡å€å¡Š --- */
        .content-card {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.03), 0 2px 4px -2px rgb(0 0 0 / 0.03);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
        }
        
        /* --- äº’å‹•å…ƒä»¶é€šç”¨æ¨£å¼ --- */
        .interactive-tab-button.active {
            font-weight: 700;
            color: #111827;
        }
        .interactive-tab-content { display: none; }
        .interactive-tab-content.active { display: block; }

        /* --- éŒ¦å¸‚å ´å€å¡Š --- */
        .nishiki-task-card.completed { background-color: #f0fdf4; }
        .nishiki-task-card.completed .task-title { text-decoration: line-through; color: #4ade80; }
        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .details-content.open { max-height: 1000px; }

        /* --- å•†åº—è¡—å€å¡Š --- */
        .shinkyogoku-card { border-left: 5px solid #db2777; }
        .teramachi-card { border-left: 5px solid #0d9488; }

        /* --- å››æ¡æ²³åŸç”ºå€å¡Š --- */
        .kawaramachi-tab-active { background-color: #0F766E; color: #F0EAD6; }
        .kawaramachi-tab-inactive { background-color: #E5E7EB; color: #374151; }

        /* --- é€šç”¨å½ˆå‡ºè¦–çª— (Modal) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex; align-items: center; justify-content: center;
            z-index: 1000; opacity: 0; visibility: hidden;
            transition: all 0.3s ease-in-out;
        }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        .modal-content {
            background: #f8f9fa; padding: 2rem; border-radius: 0.5rem;
            max-width: 90%; width: 650px; max-height: 90vh;
            overflow-y: auto; transform: scale(0.95);
            transition: all 0.3s ease-in-out;
        }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        
        /* --- Chart.js å®¹å™¨ --- */
        .chart-container { position: relative; width: 100%; margin: auto; height: 300px; }
        
        /* --- OpenStreetMap åœ°åœ– --- */
        #map { height: 500px; border-radius: 0.75rem; border: 1px solid #e5e7eb; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.03); }
        .leaflet-popup-content-wrapper { border-radius: 8px; }
        .leaflet-popup-content { font-family: 'Noto Sans TC', sans-serif; }
    </style>
</head>
<body class="bg-slate-50">

    <!-- é ‚éƒ¨å›ºå®šå°è¦½åˆ— -->
    <header id="main-header" class="navbar sticky top-0 z-50">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center">
                <div class="text-2xl font-bold text-amber-900 py-4">äº¬éƒ½ç¬¬äºŒå¤©ãƒ»å®Œå…¨æ”»ç•¥</div>
                <div class="hidden md:flex items-center space-x-8 text-sm font-medium text-slate-700">
                    <a href="#kinkakuji" class="nav-link">é‡‘é–£å¯º</a>
                    <a href="#nishiki" class="nav-link">éŒ¦å¸‚å ´</a>
                    <a href="#shotengai" class="nav-link">å•†åº—è¡—</a>
                    <a href="#kawaramachi" class="nav-link">å››æ¡æ²³åŸç”º</a>
                    <a href="#map-section" class="nav-link">åœ°ç†ä½ç½®</a>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="text-slate-700 focus:outline-none">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden bg-white/95 backdrop-blur-sm">
            <a href="#kinkakuji" class="block py-2 px-4 text-sm text-slate-700 hover:bg-slate-100">é‡‘é–£å¯º</a>
            <a href="#nishiki" class="block py-2 px-4 text-sm text-slate-700 hover:bg-slate-100">éŒ¦å¸‚å ´</a>
            <a href="#shotengai" class="block py-2 px-4 text-sm text-slate-700 hover:bg-slate-100">å•†åº—è¡—</a>
            <a href="#kawaramachi" class="block py-2 px-4 text-sm text-slate-700 hover:bg-slate-100">å››æ¡æ²³åŸç”º</a>
            <a href="#map-section" class="block py-2 px-4 text-sm text-slate-700 hover:bg-slate-100">åœ°ç†ä½ç½®</a>
        </div>
    </header>

    <main class="py-16 px-4 md:px-8">
        <div class="max-w-7xl mx-auto space-y-24">

            <!-- 1. é‡‘é–£å¯º -->
            <section id="kinkakuji" class="section">
                <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-bold text-slate-800">ä¸Šåˆï¼šé‡‘é–£å¯º</h2>
                    <p class="mt-4 text-lg max-w-3xl mx-auto text-slate-600">ä¸€å ´é—œæ–¼å…‰å½±ã€æ­·å²èˆ‡è™›å¯¦çš„äº’å‹•å°è¦½</p>
                </div>
                <div class="content-card p-6 md:p-8">
                    <div class="bg-amber-50 border-l-4 border-amber-500 text-amber-800 p-4 rounded-lg mb-8">
                        <h3 class="text-xl font-bold mb-2">æœ€æ–°è³‡è¨Šï¼ˆ2024/2025ï¼‰</h3>
                        <ul class="list-disc list-inside space-y-1">
                            <li><strong>é–‹æ”¾æ™‚é–“ï¼š</strong> 09:00 - 17:00 (å…¨å¹´ç„¡ä¼‘)</li>
                            <li><strong>åƒæ‹œè²»ç”¨ï¼š</strong> æˆäºº 500æ—¥åœ“ï¼Œä¸­å°å­¸ç”Ÿ 300æ—¥åœ“ã€‚</li>
                            <li><strong>åƒè§€æé†’ï¼š</strong> å»ºè­°æ—©ä¸Šæ—©é»æŠµé”ï¼Œé¿é–‹äººæ½®ï¼Œäº«å—é¡æ¹–æ± æœ€å¹³éœçš„å€’å½±ã€‚</li>
                        </ul>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
                        <div id="kinkaku-diagram" class="w-full max-w-sm mx-auto border-2 border-slate-200 bg-white rounded-lg p-4 shadow-inner">
                            <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                        </div>
                        <div id="kinkaku-layer-info" class="bg-slate-50 p-6 rounded-lg min-h-[300px]"></div>
                    </div>
                </div>
            </section>

            <!-- 2. éŒ¦å¸‚å ´ -->
            <section id="nishiki" class="section">
                <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-bold text-slate-800">ä¸­åˆï¼šéŒ¦å¸‚å ´</h2>
                    <p class="mt-4 text-lg max-w-3xl mx-auto text-slate-600">çµ¦ç¾é£Ÿçµäººçš„çµ‚æ¥µä»»å‹™æ›¸</p>
                </div>
                <div class="content-card p-6 md:p-8">
                    <div class="bg-red-50 border-l-4 border-red-500 text-red-800 p-4 rounded-lg mb-8">
                        <h3 class="text-xl font-bold mb-3">åºç« ï¼šé–‹æˆ°å‰çš„ä½œæˆ°å®ˆå‰‡</h3>
                        <p><strong>é¦–è¦åŸå‰‡ï¼šç¦æ­¢é‚Šèµ°é‚Šåƒï¼</strong> é€™æ˜¯å¸‚å ´çš„å®˜æ–¹è¦å®šï¼Œä¹Ÿæ˜¯å°åº—å®¶èˆ‡å…¶ä»–éŠå®¢çš„å°Šé‡ã€‚è«‹å‹™å¿…åœ¨åº—å®¶æ—<strong class="font-semibold">ç«™å®šå“åš</strong>ï¼Œä¸¦å°‡åƒåœ¾äº¤é‚„åº—å®¶è™•ç†ã€‚</p>
                        <p class="mt-2"><strong>æœ€æ–°æé†’ï¼š</strong> ç”±æ–¼éŠå®¢å¢å¤šï¼Œéƒ¨åˆ†åº—å®¶æœƒæ˜ç¢ºæ¨™ç¤ºç”¨é¤å€åŸŸï¼Œè«‹å‹™å¿…éµå®ˆã€‚</p>
                    </div>
                    
                    <div class="sticky top-[80px] bg-white/90 backdrop-blur-md z-10 py-4 mb-6 border-b border-slate-200">
                        <div id="nishiki-tabs" class="flex flex-wrap justify-center gap-2">
                            <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                        </div>
                    </div>

                    <div id="nishiki-tab-contents">
                        <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
            </section>

            <!-- 3. å•†åº—è¡— -->
            <section id="shotengai" class="section">
                <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-bold text-slate-800">ä¸‹åˆï¼šæ–°äº¬æ¥µ vs. å¯ºç”ºäº¬æ¥µ</h2>
                    <p class="mt-4 text-lg max-w-3xl mx-auto text-slate-600">ä¸‰å°æ™‚å®Œç¾é›™ç·šäº’å‹•æ”»ç•¥</p>
                </div>
                <div class="content-card p-6 md:p-8">
                    <div class="sticky top-[80px] bg-white/90 backdrop-blur-md z-10 shadow-sm mb-8 -mx-6 md:-mx-8 -mt-6 md:-mt-8">
                        <div class="max-w-5xl mx-auto flex justify-center items-center space-x-2 sm:space-x-4 md:space-x-8 p-3 text-sm md:text-base font-medium text-stone-500 overflow-x-auto">
                            <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                        </div>
                    </div>
                    <div id="shotengai-contents">
                        <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
            </section>
            
            <!-- 4. å››æ¡æ²³åŸç”º -->
            <section id="kawaramachi" class="section">
                 <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-bold text-slate-800">å‚æ™šï¼šå››æ¡æ²³åŸç”ºä¹‹å¤œ</h2>
                    <p class="mt-4 text-lg max-w-3xl mx-auto text-slate-600">çµ¦å“å‘³å®¶åº­çš„äº’å‹•è³¼ç‰©èˆ‡æ™šé¤ç­–ç•¥</p>
                </div>
                <div class="content-card p-6 md:p-8">
                    <nav class="flex justify-center mb-8 rounded-lg shadow-sm p-1 bg-stone-200 max-w-sm mx-auto">
                        <button id="show-shopping" class="w-1/2 py-2 px-4 rounded-md text-sm font-medium focus:outline-none transition-colors kawaramachi-tab-active">ğŸ›ï¸ è³¼ç‰©ç­–ç•¥</button>
                        <button id="show-dining" class="w-1/2 py-2 px-4 rounded-md text-sm font-medium focus:outline-none transition-colors kawaramachi-tab-inactive">ğŸ½ï¸ æ™šé¤æ±ºç­–</button>
                    </nav>
                    <div id="shopping-section">
                         <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    <div id="dining-section" class="hidden">
                         <!-- JS å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
            </section>

            <!-- 5. åœ°ç†ä½ç½®åœ°åœ– -->
            <section id="map-section" class="section">
                <div class="text-center mb-12">
                    <h2 class="text-4xl md:text-5xl font-bold text-slate-800">åœ°ç†ä½ç½®ç¸½è¦½</h2>
                    <p class="mt-4 text-lg max-w-3xl mx-auto text-slate-600">é»æ“Šåœ°åœ–ä¸Šçš„æ¨™è¨˜ï¼ŒæŸ¥çœ‹å„æ™¯é»çš„ç›¸å°ä½ç½®ã€‚</p>
                </div>
                <div class="content-card p-2">
                    <div id="map"></div>
                </div>
            </section>

        </div>
    </main>
    
    <!-- é€šç”¨å½ˆå‡ºè¦–çª— -->
    <div id="modal-container" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-start border-b pb-3 mb-4">
                <h3 id="modal-title" class="text-2xl font-bold text-slate-800"></h3>
                <button id="modal-close" class="text-3xl text-slate-500 hover:text-slate-800 leading-none">&times;</button>
            </div>
            <div id="modal-body" class="prose max-w-none prose-p:text-slate-700"></div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- å…¨å±€è³‡æ–™ ---
    const AppData = {
        kinkakuji: {
            layers: {
                '3': { title: 'ä¸‰å±¤ã€Œç©¶ç«Ÿé ‚ã€ï¼šç¦ªå®—èˆ‡å›æ¬Šçš„é ‚å³°', content: `<p>æ¡ç”¨ä¸­åœ‹å”ä»£é¢¨æ ¼çš„ã€Œç¦ªå®—ä½›æ®¿é€ ã€ï¼Œæ“æœ‰ç¨ç‰¹çš„ç«ç„°å½¢ã€ŒèŠ±é ­çª—ã€ã€‚é€™è£¡æ˜¯ç´”ç²¹çš„å®—æ•™ç©ºé–“ã€‚</p><p>ç¾©æ»¿å°‡è‡ªå·±è™”ä¿¡çš„ç¦ªå®—ç½®æ–¼æœ€é«˜é»ï¼Œè±¡å¾µç²¾ç¥ä¸–ç•Œå‡Œé§•ä¸–ä¿—æ¬ŠåŠ›ã€‚å±‹é ‚çš„é‡‘é³³å‡°æ˜¯ã€Œè–å¤©å­ã€æ²»ä¸–çš„ç¥¥ç‘ä¹‹é³¥ï¼Œå…¶æ„åœ–æ˜­ç„¶è‹¥æ­ã€‚</p>` },
                '2': { title: 'äºŒå±¤ã€Œæ½®éŸ³æ´ã€ï¼šæ­¦å®¶æ¬ŠåŠ›çš„æ­£åˆ', content: `<p>æ¡ç”¨éŒå€‰æ™‚ä»£ä»¥ä¾†æ­¦å£«éšç´šçš„ã€Œæ­¦å®¶é€ ã€é¢¨æ ¼ï¼Œæ›´ç‚ºå°é–‰ã€èŠé‡ï¼Œè±¡å¾µæ­¦å£«çš„å‹™å¯¦èˆ‡æ¬Šå¨ã€‚</p><p>å¾é€™ä¸€å±¤é–‹å§‹ï¼Œå…§å¤–éƒ½å¥¢è¯åœ°é‹ªä¸Šé‡‘ç®”ï¼Œä»£è¡¨è¶³åˆ©ç¾©æ»¿è‡ªèº«çš„éšç´šâ€”â€”æ­¦å®¶çš„æ¬ŠåŠ›ï¼Œæ­£è™•æ–¼å¦‚æ—¥ä¸­å¤©çš„è¼ç…Œæ™‚åˆ»ã€‚</p>` },
                '1': { title: 'ä¸€å±¤ã€Œæ³•æ°´é™¢ã€ï¼šå…¬å®¶è²´æ—çš„é»ƒæ˜', content: `<p>æ¡ç”¨å¹³å®‰æ™‚ä»£è²´æ—å®…é‚¸çš„ã€Œå¯¢æ®¿é€ ã€é¢¨æ ¼ï¼Œç‰¹é»æ˜¯é–‹æ”¾å¼çµæ§‹ï¼Œèˆ‡æ± æ°´è¦ªè¿‘ï¼Œç‡Ÿé€ å„ªé›…æ°›åœã€‚</p><p>æ­¤å±¤å®Œå…¨æ²’æœ‰è²¼é‡‘ç®”ï¼Œä¿ç•™æœ¨æç´ é›…æœ¬è‰²ã€‚é€™æ˜¯è¶³åˆ©ç¾©æ»¿çš„æ”¿æ²»å§¿æ…‹ï¼šå°‡ä»£è¡¨èˆŠæ™‚ä»£æ¬ŠåŠ›çš„å…¬å®¶æ–‡åŒ–ï¼Œç½®æ–¼è‡ªå·±æ¬ŠåŠ›çµæ§‹çš„æœ€åº•å±¤ã€‚</p>` }
            },
            garden: [
                { title: 'é™¸èˆŸä¹‹æ¾', content: '<p>æ“šå‚³ç”±è¶³åˆ©ç¾©æ»¿è¦ªæ‰‹æ ½ç¨®ï¼Œæ¨¹é½¡è¶…éå…­ç™¾å¹´ã€‚å…¶æ¨¹å† è¢«ä¿®å‰ªæˆä¸€è‰˜å¸†èˆ¹çš„å½¢ç‹€ï¼Œèˆ¹é ­æœå‘è¥¿æ–¹â€”â€”é˜¿å½Œé™€ä½›çš„æ¥µæ¨‚æ·¨åœŸã€‚</p>' },
                { title: 'é¾é–€ç€‘èˆ‡é¯‰é­šçŸ³', content: '<p>æ­¤æ™¯è§€æ¼”ç¹¹äº†ä¸­åœ‹ã€Œé¯‰é­šèºé¾é–€ã€çš„å¤è€å‚³èªªã€‚ç€‘å¸ƒä¸‹å‚¾æ–œçš„çŸ³é ­æ˜¯ã€Œé¯‰é­šçŸ³ã€ï¼Œå½·å½¿æ­£å¥®åŠ›é€†æµè€Œä¸Šã€‚</p>' },
                { title: 'éŠ€æ²³æ³‰èˆ‡åš´ä¸‹æ°´', content: '<p>éŠ€æ²³æ³‰å‚³èªªæ˜¯è¶³åˆ©ç¾©æ»¿ç”¨ä¾†æ³¡èŒ¶çš„æ³‰æ°´ï¼Œåš´ä¸‹æ°´å‰‡æ˜¯ä»–æ´—æ‰‹çš„æ°´æºã€‚ç‚ºå®å‰åº­åœ’å¢æ·»äº†äººæ€§çš„æº«åº¦ã€‚</p>' },
                { title: 'å¤•ä½³äº­', content: '<p>ä¸€åº§èŒ…è‰å±‹é ‚çš„èŒ¶å®¤ï¼Œå…¶åæ„ç‚ºã€Œå¤•é™½ä¸‹çš„æ™¯è‰²çµ•ä½³ã€ã€‚å®ƒé«”ç¾äº†èˆ‡é‡‘é–£çš„è¯éº—å½¢æˆå¼·çƒˆå°æ¯”çš„ã€Œä¾˜å¯‚ã€ç¾å­¸ã€‚</p>' }
            ]
        },
        nishiki: {
            tabs: [
                { id: 'nishiki-tab1', name: 'é¹¹é£Ÿé¡å‰é‹’', color: '#c2410c' },
                { id: 'nishiki-tab2', name: 'æµ·ä¹‹æ©æƒ ', color: '#0f766e' },
                { id: 'nishiki-tab3', name: 'ç”œèœœçš„ä¸­å ´ä¼‘æ¯', color: '#a16207' }
            ],
            tasks: {
                'nishiki-tab1': [
                    { title: 'é«˜æ¹¯ç‰å­ç‡’', shop: 'ä¸‰æœ¨é¶åµ', guide: 'å£æ„Ÿæ¿•æ½¤ã€ç†±æ°£é¨°é¨°ï¼Œæ¯ä¸€å£éƒ½æ»¿æº¢è‘—é«˜é›…çš„æ¹¯æ±ã€‚', completed: false },
                    { title: 'ç« é­šè›‹', shop: 'æ«‚ KAI', guide: 'å°ç« é­šçš„é ­è£¡å¡æ»¿éµªé¶‰è›‹ï¼Œè¦–è¦ºèˆ‡å‘³è¦ºçš„é›™é‡é©šå–œã€‚', completed: false },
                    { title: 'ç¾çƒ¤ä»™è²', shop: 'å¯ºå­å±‹æœ¬èˆ—', guide: 'å‹™å¿…å˜—è©¦æº«ç†±çš„ã€Œã¬ã‚ŒãŠã‹ãã€ï¼ˆæ¿•ä»™è²ï¼‰ï¼Œå£æ„Ÿä»‹æ–¼éº»ç³¬èˆ‡ä»™è²ä¹‹é–“ã€‚', completed: false }
                ],
                'nishiki-tab2': [
                    { title: 'ç”Ÿé­šç‰‡/çƒ¤æµ·é®®ä¸²', shop: 'é®®é­šæœ¨æ‘', guide: 'ç”¨å¸‚å ´åƒ¹æ ¼å“åšæ–™äº­ç­‰ç´šçš„å¥¢è¯ï¼Œé­šè‚‰åœ¨èˆŒå°–åŒ–é–‹ã€‚', completed: false },
                    { title: 'é°»é­šè‚ä¸²', shop: 'å·é­š ã®ã¨ã‚ˆ', guide: 'æˆç†Ÿã€ç•¥å¸¶ç”˜é†‡çš„è‹¦å‘³ï¼Œè¢«ç™¾å¹´é†¬æ±çš„é†‡åšç”œç¾æ‰€å¹³è¡¡ï¼Œæ˜¯ã€Œå¤§äººæ„Ÿã€çš„é¢¨å‘³ã€‚', completed: false }
                ],
                'nishiki-tab3': [
                    { title: 'è±†ä¹³ç”œç”œåœˆ & å†°æ·‡æ·‹', shop: 'ã“ã‚“ãªã‚‚ã‚“ã˜ã‚ƒ', guide: 'å¤–æ®¼é…¥è„†ï¼Œå…§éƒ¨è“¬é¬†æŸ”è»Ÿã€‚å‹™å¿…è¿½åŠ æ¿ƒéƒçš„è±†ä¹³å†°æ·‡æ·‹ä¸€åŒäº«ç”¨ã€‚', completed: false },
                    { title: 'é®®æ¦¨æœæ±', shop: 'å¸‚å ´ä¸­å„è”¬æœæ”¤', guide: 'çµ•ä½³çš„å‘³è¦ºè½‰æ›å™¨ï¼ç´”ç²¹ã€æ¸…æ–°çš„é…¸ç”œèƒ½æ´—å»å£ä¸­æ®˜ç•™çš„é¹¹å‘³èˆ‡æ²¹è†©æ„Ÿã€‚', completed: false }
                ]
            }
        },
        shotengai: {
            tabs: [
                { target: 'shotengai-overview', name: 'è·¯ç·šç¸½è¦½', color: '#6b7280' },
                { target: 'shotengai-shinkyogoku', name: 'é’æ˜¥å·¡ç¦®ç¯‡', color: '#db2777' },
                { target: 'shotengai-teramachi', name: 'æ–‡åŒ–å°‹å¯¶ç¯‡', color: '#0d9488' }
            ],
            shinkyogoku: [
                { icon: 'ğŸ€', title: 'è§’è‰²å¤©å ‚ï¼šä¸‰éº—é·—å°ˆè³£åº—', desc: 'å°‹æ‰¾ Hello Kitty èˆ‡å¥¹çš„æœ‹å‹å€‘ï¼Œåˆ¥å¿˜äº†æ‰¾æ‰¾äº¬éƒ½é™å®šçš„å’Œé¢¨è¨­è¨ˆæ¬¾ã€‚' },
                { icon: 'ğŸ¤–', title: 'æ‰­è›‹ç‰†ï¼š#C-pla', desc: 'æº–å‚™å¥½é›¶éŒ¢ï¼é€™è£¡æœ‰è¶…é800å°æ‰­è›‹æ©Ÿï¼Œé«”é©—æ—¥æœ¬ç¨ç‰¹çš„æ‰­è›‹å®‡å®™ï¼' },
                { icon: 'ğŸ“¸', title: 'å¤§é ­è²¼æ©Ÿï¼šGiGOéŠæˆ²ä¸­å¿ƒ', desc: 'æ¯å¥³ä¸€èµ·é«”é©—çš„çµ•ä½³æ´»å‹•ï¼è£½ä½œä¸€ä»½å……æ»¿æ—¥æœ¬ã€Œå¡å“‡ä¼Šã€ç‰¹è‰²çš„ç¾é¡ç´€å¿µç…§ã€‚' },
                { icon: 'ğŸ’„', title: 'æµè¡Œæœé£¾èˆ‡è—¥å¦', desc: 'æ—ç«‹è‘—åƒ¹æ ¼è¦ªæ°‘çš„æœé£¾åº—èˆ‡å¤§å‹è—¥å¦åº—ï¼Œæ˜¯ç™¼æ˜æ—¥ç³»ç©¿æ­èˆ‡è£œè²¨çš„å¥½åœ°æ–¹ã€‚' }
            ],
            teramachi: [
                { icon: 'ğŸ“œ', title: 'ç™¾å¹´è€èˆ–ï¼šé³©å±…å ‚', desc: 'å‰µç«‹è¶…é360å¹´ï¼Œåº—å…§æ··åˆè‘—ç™½æª€ã€æ²‰é¦™çš„å„ªé›…æ°£å‘³ï¼Œè²©å”®é ‚ç´šç·šé¦™èˆ‡çµ•ç¾å’Œç´™ã€‚' },
                { icon: 'ğŸ–¼ï¸', title: 'æ–‡é’èˆ‡è—è¡“å®¶ï¼šå¤§æ›¸å ‚', desc: 'å°ˆç‡Ÿå¤æ›¸èˆ‡ç‰ˆç•«çš„å¤æ›¸åº—ï¼Œç‰¹åˆ¥æ˜¯æ±Ÿæˆ¶æ™‚ä»£è‡³ä»Šçš„æµ®ä¸–ç¹ªï¼Œåƒä¸€åº§å¾®å‹ç¾è¡“é¤¨ã€‚' },
                { icon: 'ğŸ”ª', title: 'è·äººæ‰‹ä½œçš„æº«åº¦', desc: 'è²©å”®å°ˆæ¥­å»šåˆ€çš„ã€Œæœ‰æ¬¡ã€ï¼Œæˆ–è£½ä½œä½›ç çš„å°ˆé–€åº—ï¼Œæ‰¿è¼‰äº¬éƒ½çš„åŒ äººç²¾ç¥ã€‚' },
                { icon: 'ğŸµ', title: 'èŒ¶é¦™èˆ‡å¤ç¾è¡“', desc: 'æ•£ä½ˆè‘—ç•«å»Šã€å¤ç¾è¡“åº—èˆ‡èŒ¶è‘‰åº—ã€‚å³ä½¿ä¸è²·ï¼Œæ”¾æ…¢è…³æ­¥æ¬£è³æ«¥çª—ä¹Ÿæ˜¯ä¸€ç¨®äº«å—ã€‚' }
            ]
        },
        kawaramachi: {
            shopping: [
                { id: 'takashimaya', title: 'äº¬éƒ½é«˜å³¶å±‹ S.C.', subtitle: 'The Classic & Modern Hybrid', desc: 'å“å‘³èˆ‡ä¿¡è³´çš„æ®¿å ‚ï¼Œèåˆç¶“å…¸ç²¾å“èˆ‡ç¾ä»£æ½®æµå…ƒç´ ï¼Œæ˜¯å…¼é¡§å„å¹´é½¡å±¤éœ€æ±‚çš„ä¸€ç«™å¼è§£æ±ºæ–¹æ¡ˆã€‚', content: `<h4>æ ¸å¿ƒå®šä½ï¼šç¶“å…¸æ®¿å ‚èˆ‡ç¾ä»£æ´»åŠ›çš„èåˆ</h4><p>äº¬éƒ½é«˜å³¶å±‹æ˜¯é€™åº§åŸå¸‚çš„æ®¿å ‚ç´šç™¾è²¨ã€‚2023å¹´é–‹å¹•çš„å…¨æ–°å°ˆé–€åº—å€åŸŸã€ŒT8ã€ï¼Œç‚ºé€™åº§ç¶“å…¸æ®¿å ‚æ³¨å…¥äº†ä»¤äººé©šå–œçš„ç¾ä»£æ´»åŠ›ï¼Œå¼•é€²å¦‚<strong>ã€ŒNintendo KYOTOã€</strong>ã€äººæ°£æ›¸åº—<strong>ã€Œè”¦å±‹æ›¸åº—ã€</strong>ç­‰è©±é¡Œååº—ã€‚</p><h4>ç‰¹åˆ¥æ¨è–¦ï¼šDEPACHIKA åœ°ä¸‹ç¾é£Ÿè¡—</h4><p>ç„¡è«–æ˜¯å¦åœ¨æ­¤ç”¨é¤ï¼Œéƒ½çµ•å°è¦å»åœ°ä¸‹ä¸€æ¨“çš„é£Ÿå“è³£å ´ã€ŒDEPACHIKAã€å·¡ç¦®ã€‚æ¨è–¦è€èˆ–ã€Œã¨ã‚‰ã‚„ã€çš„ç¾Šç¾¹èˆ‡ã€ŒMALEBRANCHEã€çš„æŠ¹èŒ¶é¤…ä¹¾ã€ŒèŒ¶ã®è“ã€ã€‚</p>` },
                { id: 'fujii-daimaru', title: 'è—¤äº•å¤§ä¸¸', subtitle: 'The Fashion-Forward', desc: 'ç»çµ¦æ™‚å°šæ„›å¥½è€…çš„è–åœ°ï¼Œé›†åˆåœ‹å…§å¤–å‰è¡›èˆ‡æ½®æµå“ç‰Œï¼Œæ˜¯å¹´è¼•äººçš„ç†æƒ³ä¸»å ´ã€‚', content: `<h4>æ ¸å¿ƒå®šä½ï¼šæ™‚å°šå‰æ²¿ç­–å±•åœ°</h4><p>å¦‚æœèªªé«˜å³¶å±‹æ˜¯ç¶“å…¸çš„è–æ®¿ï¼Œé‚£éº¼è—¤äº•å¤§ä¸¸ç„¡ç–‘æ˜¯ç»çµ¦æ™‚å°šä¿¡å¾’çš„è–åœ°ã€‚å®ƒåƒä¸€åº§å‚ç›´å †ç–Šçš„æ™‚å°šç²¾å“é¸ç‰©å¤§æ¨“ï¼Œç²¾æº–åœ°æŠ“ä½äº†ç•¶ä¸‹å¹´è¼•äººçš„æ™‚å°šè„ˆæã€‚</p><h4>å“ç‰Œé™£å®¹äº®é»</h4><p>SNIDEL, FRAY I.D, MAISON KITSUNÃ‰, COMME des GARÃ‡ONS ç­‰ã€‚</p>` },
                { id: 'bal', title: 'äº¬éƒ½BAL', subtitle: 'The Curated Luxury', desc: 'ç¾è¡“é¤¨èˆ¬çš„éœè¬è³¼ç‰©ç©ºé–“ï¼Œç²¾å¿ƒæŒ‘é¸çš„å“ç‰Œçµ„åˆï¼Œé©åˆè¿½æ±‚æ¥µè‡´å“å‘³èˆ‡æ”¾é¬†æ°›åœçš„å®¶åº­ã€‚', content: `<h4>æ ¸å¿ƒå®šä½ï¼šç²¾å¿ƒç­–å±•çš„å¥¢è¯é«”é©—</h4><p>äº¬éƒ½BALæä¾›çš„æ˜¯ä¸€ç¨®ã€Œä½œç‚ºä¼‘é–’çš„è³¼ç‰©ã€é«”é©—ã€‚å®ƒé¡›è¦†äº†æ“æ“ å–§é¬§çš„ç™¾è²¨å°è±¡ï¼Œä»¥å¯¬æ•ã€éœè¬ã€å®›å¦‚ç¾è¡“é¤¨èˆ¬çš„ç©ºé–“è¨­è¨ˆï¼Œå°‡å“å‘³æå‡è‡³å…¨æ–°å¢ƒç•Œã€‚</p><h4>æ ¸å¿ƒç§Ÿæˆ¶èˆ‡ç‰¹è‰²</h4><p>å¤§å‹æ›¸åº— MARUZENã€ç”Ÿæ´»é¢¨æ ¼å“ç‰Œ Ron Hermanã€ä¸–ç•Œç´šé¦™æ°›ç¾å¦ Diptyque ç­‰ã€‚</p>` }
            ],
            dining: [
                { id: 'dining-elegance', title: 'ç™¾è²¨é«˜å±¤çš„å„ªé›…', subtitle: 'ELEGANCE & CONVENIENCE', desc: 'åœ¨è³¼ç‰©å¾Œç„¡ç¸«æ¥è»Œï¼Œäº«å—èˆ’é©ç’°å¢ƒèˆ‡å“è³ªç©©å®šçš„é«”é¢æ™šé¤ã€‚', content: `<h4>åœ°é»</h4><p>äº¬éƒ½é«˜å³¶å±‹S.C. 7æ¨“ã€Œäº¬å›å»Šã€é¤å»³è¡—ã€‚</p><h4>å„ªé»</h4><p>ç’°å¢ƒèˆ’é©ã€å“è³ªç©©å®šã€é¸æ“‡å¤šæ¨£ã€‚</p><h4>ç¼ºé»</h4><p>åƒ¹æ ¼åé«˜ã€è¼ƒæ—©çµæŸç‡Ÿæ¥­ã€‚</p><h4>æ¨è–¦åº—å®¶</h4><p>ã¨ã‚“ã‹ã¤å’Œå¹¸ (ç‚¸è±¬æ’), ã‚°ãƒªãƒ«ã‚­ãƒ£ãƒ”ã‚¿ãƒ« æ±æ´‹äº­ (ç™¾å¹´æ¼¢å ¡æ’)ã€‚</p>` },
                { id: 'dining-atmosphere', title: 'å…ˆæ–—ç”ºã®é¢¨æƒ…', subtitle: 'ATMOSPHERE & ADVENTURE', desc: 'æ²‰æµ¸åœ¨çµ•ä½³çš„äº¬éƒ½å¤œæ™šæ°›åœä¸­ï¼Œé«”é©—å……æ»¿æ¢ç´¢æ¨‚è¶£çš„ä¸€é¤ã€‚', content: `<h4>åœ°é»</h4><p>é´¨å·æ—å……æ»¿æ±Ÿæˆ¶é¢¨æƒ…çš„çŸ³æ¿å°å··ã€Œå…ˆæ–—ç”ºã€ã€‚</p><h4>å„ªé»</h4><p>çµ•ä½³çš„äº¬éƒ½å¤œæ™šæ°›åœã€å……æ»¿æ¢ç´¢æ¨‚è¶£ã€‚</p><h4>ç¼ºé»</h4><p>åƒ¹æ ¼ä¸ä¸€ï¼Œéƒ¨åˆ†åº—å®¶å°éŠå®¢æœ‰é–€æª»ã€‚</p><h4>æ•™æˆ°å®ˆå‰‡</h4><p>å„ªå…ˆé¸æ“‡é–€å£æœ‰æ”¾ç½®é™„<b>ç…§ç‰‡èˆ‡åƒ¹æ ¼èœå–®</b>çš„åº—å®¶ã€‚</p>` },
                { id: 'dining-casual', title: 'å‘¨é‚Šå··å¼„çš„æ—¥å¸¸', subtitle: 'CASUAL & AUTHENTIC', desc: 'é€›è¡—ç´¯äº†ï¼Ÿä¾†ä¸€é “å¿«é€Ÿã€ç¾å‘³ã€é«˜CPå€¼ä¸”ç„¡è² æ“”çš„é“åœ°æ™šé¤ã€‚', content: `<h4>åœ°é»</h4><p>ç™¾è²¨å‘¨é‚Šçš„å°å··æˆ–é€£é–é¤å»³ã€‚</p><h4>å„ªé»</h4><p>æ€§åƒ¹æ¯”é«˜ã€å¿«é€Ÿã€èƒ½å“åšåˆ°æœ¬åœ°äººå–œæ„›çš„å‘³é“ã€‚</p><h4>ç¼ºé»</h4><p>ç”¨é¤ç’°å¢ƒå¯èƒ½è¼ƒç‚ºç°¡å–®ã€‚</p><h4>æ¨è–¦åº—å®¶</h4><p>éººå±‹ çŒªä¸€ (ç±³å…¶æ—æ¨è–¦æ‹‰éºµ), ã‚„ã‚ˆã„è»’ (æ—¥å¼å®šé£Ÿ)ã€‚</p>` }
            ]
        },
        mapLocations: [
            { lat: 35.03939, lng: 135.72924, name: 'é‡‘é–£å¯º (é¹¿è‹‘å¯º)', desc: 'é‡‘ç¢§è¼ç…Œçš„èˆåˆ©æ®¿ï¼Œæ˜¯äº¬éƒ½çš„è±¡å¾µä¹‹ä¸€ã€‚' },
            { lat: 35.0049, lng: 135.7680, name: 'éŒ¦å¸‚å ´', desc: 'è¢«è­½ç‚ºã€Œäº¬éƒ½çš„å»šæˆ¿ã€ï¼Œç¾é£Ÿé›²é›†ã€‚' },
            { lat: 35.0068, lng: 135.7685, name: 'æ–°äº¬æ¥µãƒ»å¯ºç”ºäº¬æ¥µå•†åº—è¡—', desc: 'å…©æ¢å¹³è¡Œä½†é¢¨æ ¼è¿¥ç•°çš„å•†åº—è¡—ã€‚' },
            { lat: 35.0038, lng: 135.7695, name: 'å››æ¡æ²³åŸç”ºåå­—è·¯å£', desc: 'äº¬éƒ½æœ€ç¹è¯çš„è³¼ç‰©èˆ‡äº¤é€šä¸­å¿ƒã€‚' }
        ]
    };

    // --- é€šç”¨å‡½æ•¸ ---
    const modalContainer = document.getElementById('modal-container');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');

    function showModal(title, content) {
        modalTitle.textContent = title;
        modalBody.innerHTML = content;
        modalContainer.classList.add('visible');
    }
    function hideModal() {
        modalContainer.classList.remove('visible');
    }
    modalClose.addEventListener('click', hideModal);
    modalContainer.addEventListener('click', (e) => {
        if (e.target === modalContainer) hideModal();
    });

    // --- æ‰‹æ©Ÿç‰ˆé¸å–® ---
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
    });

    // --- å°è¦½åˆ—æ»¾å‹•æ•ˆæœ ---
    const header = document.getElementById('main-header');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
            header.classList.add('navbar-scrolled');
        } else {
            header.classList.remove('navbar-scrolled');
        }
    });

    // --- é‡‘é–£å¯ºå€å¡Šåˆå§‹åŒ– ---
    function initKinkakuji() {
        const diagramContainer = document.getElementById('kinkaku-diagram');
        const layerInfoContainer = document.getElementById('kinkaku-layer-info');
        
        // å‰µå»ºèˆåˆ©æ®¿åœ–ç¤º
        Object.keys(AppData.kinkakuji.layers).sort().reverse().forEach(layerId => {
            const layerData = AppData.kinkakuji.layers[layerId];
            const layerDiv = document.createElement('div');
            layerDiv.className = 'kinkaku-layer text-center p-4 border-b-2 border-dashed border-amber-800/20 cursor-pointer transition-all duration-300 hover:bg-amber-50';
            layerDiv.dataset.layer = layerId;
            layerDiv.innerHTML = `
                <span class="text-sm font-bold text-amber-900">ç¬¬${{'1':'ä¸€','2':'äºŒ','3':'ä¸‰'}[layerId]}å±¤</span>
                <h4 class="text-xl font-serif">${layerData.title.split('ï¼š')[0]}</h4>
            `;
            diagramContainer.appendChild(layerDiv);
        });

        const kinkakuLayers = diagramContainer.querySelectorAll('.kinkaku-layer');

        function updateLayerInfo(layerId) {
            const data = AppData.kinkakuji.layers[layerId];
            layerInfoContainer.innerHTML = `
                <h4 class="text-xl font-bold text-slate-800 mb-4">${data.title}</h4>
                <div class="prose prose-sm max-w-none prose-p:text-slate-700">${data.content}</div>`;
            kinkakuLayers.forEach(layer => {
                layer.classList.toggle('bg-amber-100', layer.dataset.layer === layerId);
                layer.classList.toggle('border-l-4', layer.dataset.layer === layerId);
                layer.classList.toggle('border-amber-500', layer.dataset.layer === layerId);
            });
        }

        kinkakuLayers.forEach(layer => {
            layer.addEventListener('click', () => updateLayerInfo(layer.dataset.layer));
        });

        updateLayerInfo('1'); // é è¨­é¡¯ç¤ºç¬¬ä¸€å±¤
    }

    // --- éŒ¦å¸‚å ´å€å¡Šåˆå§‹åŒ– ---
    function initNishiki() {
        const tabsContainer = document.getElementById('nishiki-tabs');
        const tabContentsContainer = document.getElementById('nishiki-tab-contents');

        AppData.nishiki.tabs.forEach((tabData, index) => {
            const button = document.createElement('button');
            button.dataset.tab = tabData.id;
            button.className = `interactive-tab-button text-sm md:text-base font-semibold py-2 px-4 rounded-full border-2 transition`;
            button.textContent = tabData.name;
            if (index === 0) {
                button.classList.add('active');
                button.style.borderColor = tabData.color;
                button.style.color = tabData.color;
                button.style.backgroundColor = `${tabData.color}1a`;
            } else {
                button.style.borderColor = 'transparent';
            }
            tabsContainer.appendChild(button);

            const contentDiv = document.createElement('div');
            contentDiv.id = tabData.id;
            contentDiv.className = 'interactive-tab-content space-y-4';
            if (index === 0) contentDiv.classList.add('active');
            
            AppData.nishiki.tasks[tabData.id].forEach(item => {
                contentDiv.appendChild(createTaskCard(item));
            });
            tabContentsContainer.appendChild(contentDiv);
        });

        const tabs = tabsContainer.querySelectorAll('.interactive-tab-button');
        const tabContents = tabContentsContainer.querySelectorAll('.interactive-tab-content');

        tabs.forEach((tab, index) => {
            tab.addEventListener('click', () => {
                const tabData = AppData.nishiki.tabs[index];
                tabs.forEach((t, i) => {
                    t.classList.remove('active');
                    t.style.borderColor = 'transparent';
                    t.style.color = '';
                    t.style.backgroundColor = '';
                });
                tabContents.forEach(c => c.classList.remove('active'));

                tab.classList.add('active');
                tab.style.borderColor = tabData.color;
                tab.style.color = tabData.color;
                tab.style.backgroundColor = `${tabData.color}1a`;
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });

        function createTaskCard(item) {
            const card = document.createElement('div');
            card.className = 'nishiki-task-card bg-white p-4 rounded-lg shadow-sm cursor-pointer transition border border-gray-200 hover:border-gray-400';
            card.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input type="checkbox" class="task-checkbox h-6 w-6 text-orange-600 rounded-md border-gray-300 mr-4 focus:ring-orange-500">
                        <div class="flex-grow">
                            <h4 class="task-title text-lg font-semibold text-stone-800">${item.title}</h4>
                            <p class="text-sm text-stone-500">${item.shop}</p>
                        </div>
                    </div>
                    <span class="expand-arrow text-2xl text-stone-400 transform transition-transform">â–¼</span>
                </div>
                <div class="details-content mt-4 border-t pt-4 text-stone-600">
                    <p>${item.guide}</p>
                </div>`;
            
            const checkbox = card.querySelector('.task-checkbox');
            checkbox.addEventListener('click', (e) => {
                e.stopPropagation();
                card.classList.toggle('completed');
            });

            card.addEventListener('click', () => {
                const details = card.querySelector('.details-content');
                const arrow = card.querySelector('.expand-arrow');
                details.classList.toggle('open');
                arrow.style.transform = details.classList.contains('open') ? 'rotate(180deg)' : 'none';
            });
            return card;
        }
    }

    // --- å•†åº—è¡—å€å¡Šåˆå§‹åŒ– ---
    function initShotengai() {
        const navContainer = document.querySelector('#shotengai .max-w-5xl');
        const contentContainer = document.getElementById('shotengai-contents');

        AppData.shotengai.tabs.forEach((tabData, index) => {
            const button = document.createElement('button');
            button.dataset.target = tabData.target;
            button.dataset.color = tabData.color;
            button.className = 'interactive-tab-button py-3 px-2 sm:px-4';
            button.textContent = tabData.name;
            if (index === 0) {
                button.classList.add('active');
                button.style.borderBottom = `3px solid ${tabData.color}`;
            }
            navContainer.appendChild(button);
        });

        // ç¸½è¦½å…§å®¹
        const overviewContent = `
            <div id="shotengai-overview" class="interactive-tab-content active">
                <div class="text-center mb-12">
                    <h3 class="text-2xl font-bold mb-4">ä¸€æ¢é¦¬è·¯ï¼Œå…©å€‹ä¸–ç•Œ</h3>
                    <p class="max-w-3xl mx-auto text-stone-600 leading-relaxed">é€™è£¡æœ‰å…©æ¢å¹³è¡Œçš„å•†åº—è¡—ï¼Œå»å±•ç¾å‡ºæˆªç„¶ä¸åŒçš„é¢¨è²Œã€‚é»æ“Šä¸Šæ–¹é ç±¤ï¼Œåˆ‡æ›ä¸åŒä¸»é¡Œçš„æ¢ç´¢ä¹‹æ—…å§ï¼</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-slate-50 p-6 rounded-xl"><h4 class="text-xl font-semibold text-center mb-4">å•†åº—è¡—é¢¨æ ¼å°æ¯”</h4><div class="chart-container" style="height: 250px;"><canvas id="shotengai-styleChart"></canvas></div></div>
                    <div class="bg-slate-50 p-6 rounded-xl"><h4 class="text-xl font-semibold text-center mb-4">ä¸‰å°æ™‚æ”»ç•¥æ™‚é–“è»¸</h4><div class="chart-container" style="height: 250px;"><canvas id="shotengai-timelineChart"></canvas></div></div>
                </div>
            </div>`;
        contentContainer.innerHTML += overviewContent;

        // æ–°äº¬æ¥µå…§å®¹
        const shinkyogokuContent = `
            <div id="shotengai-shinkyogoku" class="interactive-tab-content">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold text-fuchsia-600">æ–°äº¬æ¥µï¼šç»çµ¦18æ­²çš„é’æ˜¥å·¡ç¦®</h3>
                    <p class="mt-4 text-stone-600">ä¸€åŒæ„Ÿå—äº¬éƒ½æœ€æ´»æ½‘ã€æœ€æ–°æ½®çš„ä¸€é¢ã€‚</p>
                </div>
                <div id="shinkyogoku-cards" class="grid md:grid-cols-2 gap-6">
                    ${AppData.shotengai.shinkyogoku.map(item => `
                        <div class="content-card shinkyogoku-card p-6">
                            <h4 class="text-xl font-bold mb-2"><span class="mr-2">${item.icon}</span>${item.title}</h4>
                            <p class="text-stone-600">${item.desc}</p>
                        </div>`).join('')}
                </div>
            </div>`;
        contentContainer.innerHTML += shinkyogokuContent;

        // å¯ºç”ºäº¬æ¥µå…§å®¹
        const teramachiContent = `
            <div id="shotengai-teramachi" class="interactive-tab-content">
                <div class="text-center mb-12">
                    <h3 class="text-3xl font-bold text-teal-700">å¯ºç”ºäº¬æ¥µï¼šç»çµ¦çˆ¶æ¯çš„æ–‡åŒ–å°‹å¯¶</h3>
                    <p class="mt-4 text-stone-600">ç™¼æ˜æ­·å²èˆ‡å·¥è—çš„æ·±åº¦ã€‚</p>
                </div>
                <div id="teramachi-cards" class="grid md:grid-cols-2 gap-6">
                    ${AppData.shotengai.teramachi.map(item => `
                        <div class="content-card teramachi-card p-6">
                            <h4 class="text-xl font-bold mb-2"><span class="mr-2">${item.icon}</span>${item.title}</h4>
                            <p class="text-stone-600">${item.desc}</p>
                        </div>`).join('')}
                </div>
            </div>`;
        contentContainer.innerHTML += teramachiContent;

        const navButtons = navContainer.querySelectorAll('.interactive-tab-button');
        const contentSections = contentContainer.querySelectorAll('.interactive-tab-content');

        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetId = button.dataset.target;
                const color = button.dataset.color || '#6b7280';
                
                navButtons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.style.borderBottom = '3px solid transparent';
                });
                contentSections.forEach(section => section.classList.remove('active'));

                button.classList.add('active');
                button.style.borderBottom = `3px solid ${color}`;
                document.getElementById(targetId).classList.add('active');
            });
        });
        
        // Chart.js for Shotengai
        new Chart(document.getElementById('shotengai-styleChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['ç¾ä»£æ„Ÿ', 'å‚³çµ±æ„Ÿ', 'ç†±é¬§åº¦', 'å¯§éœåº¦'],
                datasets: [
                    { label: 'æ–°äº¬æ¥µ', data: [9, 2, 9, 3], backgroundColor: 'rgba(219, 39, 119, 0.6)', borderColor: 'rgba(219, 39, 119, 1)', borderWidth: 1 },
                    { label: 'å¯ºç”ºäº¬æ¥µ', data: [4, 9, 5, 8], backgroundColor: 'rgba(13, 148, 136, 0.6)', borderColor: 'rgba(13, 148, 136, 1)', borderWidth: 1 }
                ]
            },
            options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, scales: { x: { max: 10, grid: { color: '#e5e7eb' } }, y: { grid: { color: '#e5e7eb' } } }, plugins: { legend: { position: 'bottom' } } }
        });

        new Chart(document.getElementById('shotengai-timelineChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['æ´»å‹•'],
                datasets: [
                    { label: 'é’æ˜¥å·¡ç¦® (æ–°äº¬æ¥µ)', data: [[14, 15.5]], backgroundColor: 'rgba(219, 39, 119, 0.7)' },
                    { label: 'æ–‡åŒ–å°‹å¯¶ (å¯ºç”ºäº¬æ¥µ)', data: [[15.5, 17]], backgroundColor: 'rgba(13, 148, 136, 0.7)' }
                ]
            },
            options: {
                indexAxis: 'y', responsive: true, maintainAspectRatio: false,
                scales: {
                    x: { min: 14, max: 17, ticks: { stepSize: 1, callback: v => `${v}:00` }, grid: { color: '#e5e7eb' } },
                    y: { grid: { display: false } }
                },
                plugins: { legend: { position: 'bottom' } }
            }
        });
    }

    // --- å››æ¡æ²³åŸç”ºå€å¡Šåˆå§‹åŒ– ---
    function initKawaramachi() {
        // è³¼ç‰©å€å¡Š
        const shoppingSection = document.getElementById('shopping-section');
        shoppingSection.innerHTML = `
            <div class="text-center mb-8">
                <h3 class="text-2xl font-bold text-teal-800">ç¬¬ä¸€å¹•ï¼šè³¼ç‰©çŸ©é™£</h3>
                <p class="mt-2 text-stone-600 max-w-3xl mx-auto">é»æ“Šä¸‹æ–¹åœ–è¡¨æˆ–å¡ç‰‡ï¼Œå¿«é€Ÿå®šä½æœ€é©åˆæ‚¨å€‘çš„å•†åŸã€‚</p>
            </div>
            <div class="chart-container relative w-full max-w-xl mx-auto h-80 md:h-96 mb-12">
                <canvas id="shopping-chart"></canvas>
            </div>
            <div id="shopping-cards-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                ${AppData.kawaramachi.shopping.map(item => `
                    <div class="cursor-pointer content-card p-6" onclick="showModal('${item.title}', \`${item.content}\`)">
                        <h4 class="font-bold text-xl text-teal-900">${item.title}</h4>
                        <p class="text-sm font-medium text-amber-700 mt-1">${item.subtitle}</p>
                        <p class="mt-4 text-stone-600">${item.desc}</p>
                    </div>`).join('')}
            </div>`;

        // æ™šé¤å€å¡Š
        const diningSection = document.getElementById('dining-section');
        diningSection.innerHTML = `
            <div class="text-center mb-8">
                <h3 class="text-2xl font-bold text-teal-800">ç¬¬äºŒå¹•ï¼šæ™šé¤æ±ºç­–æ¨¹</h3>
                <p class="mt-2 text-stone-600 max-w-3xl mx-auto">è·Ÿéš¨ä¸‹æ–¹çš„æ±ºç­–æµç¨‹ï¼Œæˆ–ç›´æ¥é»æ“Šå¡ç‰‡ï¼Œå¿«é€Ÿé¸æ“‡æœ€å®Œç¾çš„æ™šé¤è·¯å¾‘ã€‚</p>
            </div>
            <div class="mb-12 p-6 bg-slate-50 rounded-xl">
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 text-center">
                    <div class="font-bold text-lg">æ™šé¤æƒ³è¿½æ±‚ï¼Ÿ</div>
                    <div class="text-stone-400 text-2xl hidden md:block">â†’</div>
                    <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                         <div class="border-2 border-teal-600 border-dashed rounded-lg p-3">
                            <span class="font-semibold">å„ªé›…ä¾¿åˆ©</span>
                            <div class="text-stone-400 text-2xl my-1">â†“</div>
                            <span class="bg-teal-100 text-teal-800 py-1 px-3 rounded-full">ç™¾è²¨é«˜å±¤</span>
                        </div>
                        <div class="border-2 border-amber-600 border-dashed rounded-lg p-3">
                            <span class="font-semibold">æ°›åœå†’éšª</span>
                            <div class="text-stone-400 text-2xl my-1">â†“</div>
                            <span class="bg-amber-100 text-amber-800 py-1 px-3 rounded-full">å…ˆæ–—ç”º</span>
                        </div>
                        <div class="border-2 border-stone-500 border-dashed rounded-lg p-3">
                            <span class="font-semibold">å¿«é€Ÿåœ°é“</span>
                            <div class="text-stone-400 text-2xl my-1">â†“</div>
                            <span class="bg-stone-200 text-stone-800 py-1 px-3 rounded-full">å‘¨é‚Šæ—¥å¸¸</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="dining-cards-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                ${AppData.kawaramachi.dining.map(item => `
                    <div class="cursor-pointer content-card p-6" onclick="showModal('${item.title}', \`${item.content}\`)">
                        <h4 class="font-bold text-xl text-teal-900">${item.title}</h4>
                        <p class="text-sm font-medium text-teal-700 mt-1">${item.subtitle}</p>
                        <p class="mt-4 text-stone-600">${item.desc}</p>
                    </div>`).join('')}
            </div>`;
        
        const shoppingBtn = document.getElementById('show-shopping');
        const diningBtn = document.getElementById('show-dining');
        function switchView(view) {
            shoppingSection.classList.toggle('hidden', view !== 'shopping');
            diningSection.classList.toggle('hidden', view === 'shopping');
            shoppingBtn.classList.toggle('kawaramachi-tab-active', view === 'shopping');
            shoppingBtn.classList.toggle('kawaramachi-tab-inactive', view !== 'shopping');
            diningBtn.classList.toggle('kawaramachi-tab-active', view !== 'shopping');
            diningBtn.classList.toggle('kawaramachi-tab-inactive', view === 'shopping');
        }
        shoppingBtn.addEventListener('click', () => switchView('shopping'));
        diningBtn.addEventListener('click', () => switchView('dining'));

        // Chart.js for Kawaramachi
        new Chart(document.getElementById('shopping-chart').getContext('2d'), {
            type: 'radar',
            data: {
                labels: ['ç¶“å…¸å¥¢è¯', 'å¹´è¼•æ½®æµ', 'è¨­è¨ˆå“å‘³', 'å®¶åº­åŒæ¨‚'],
                datasets: [
                    { label: 'äº¬éƒ½é«˜å³¶å±‹ S.C.', data: [9, 7, 7, 9], backgroundColor: 'rgba(15, 118, 110, 0.3)', borderColor: 'rgba(15, 118, 110, 1)', pointBackgroundColor: 'rgba(15, 118, 110, 1)' },
                    { label: 'è—¤äº•å¤§ä¸¸', data: [3, 9, 8, 4], backgroundColor: 'rgba(217, 119, 6, 0.3)', borderColor: 'rgba(217, 119, 6, 1)', pointBackgroundColor: 'rgba(217, 119, 6, 1)' },
                    { label: 'äº¬éƒ½BAL', data: [7, 6, 9, 7], backgroundColor: 'rgba(113, 113, 122, 0.3)', borderColor: 'rgba(113, 113, 122, 1)', pointBackgroundColor: 'rgba(113, 113, 122, 1)' }
                ]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { r: { angleLines: { color: '#e5e7eb' }, grid: { color: '#e5e7eb' }, pointLabels: { font: { size: 14 } }, ticks: { backdropColor: '#f8f9fa', stepSize: 2 }, min: 0, max: 10 } },
                plugins: { legend: { position: 'bottom', labels: { usePointStyle: true } } }
            }
        });
    }

    // --- åœ°åœ–åˆå§‹åŒ– ---
    function initMap() {
        const map = L.map('map').setView([35.0116, 135.7681], 13); // äº¬éƒ½ä¸­å¿ƒ
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        const goldIcon = new L.Icon({
            iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41]
        });

        AppData.mapLocations.forEach(loc => {
            L.marker([loc.lat, loc.lng], {icon: goldIcon}).addTo(map)
                .bindPopup(`<b>${loc.name}</b><br>${loc.desc}`);
        });
    }

    // --- é é¢æ»¾å‹•ç›£æ¸¬ï¼Œæ›´æ–°å°è¦½åˆ—ç‹€æ…‹ ---
    const sections = document.querySelectorAll('.section');
    const navLinks = document.querySelectorAll('.nav-link');
    window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            if (pageYOffset >= sectionTop - 100) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').substring(1) === current) {
                link.classList.add('active');
            }
        });
    });

    // --- åˆå§‹åŒ–æ‰€æœ‰å€å¡Š ---
    initKinkakuji();
    initNishiki();
    initShotengai();
    initKawaramachi();
    initMap();
});

// å°‡ showModal å‡½æ•¸æš´éœ²åˆ°å…¨åŸŸï¼Œä»¥ä¾¿ onclick å±¬æ€§å¯ä»¥è¨ªå•
window.showModal = (title, content) => {
    document.getElementById('modal-title').textContent = title;
    document.getElementById('modal-body').innerHTML = content;
    document.getElementById('modal-container').classList.add('visible');
};

</script>

</body>
</html>
